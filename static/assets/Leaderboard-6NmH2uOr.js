import{u as k,c as _,r as c,b as z,j as e,T as f,e as E,A as N,S}from"./index-DyDiUpYc.js";import{F as L}from"./flame-BR6AwHEh.js";import{m as b}from"./proxy-B2dJm0uC.js";const q=["ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰"];function A(){const{user:a}=k(),{leaderboard_enabled:t}=_(),[i,g]=c.useState([]),[p,j]=c.useState(!0),[h,v]=c.useState(""),m=c.useCallback(async()=>{try{const s=await z("/api/stats/leaderboard");g(s.leaderboard||s||[])}catch(s){v(s.message||"Failed to load leaderboard")}},[]);c.useEffect(()=>{if(!t){j(!1);return}m().finally(()=>j(!1))},[m,t]),c.useEffect(()=>{const s=()=>{m()};return window.addEventListener("ws:message",s),()=>window.removeEventListener("ws:message",s)},[m]);const d=i.length>0?Math.max(...i.map(s=>s.weekly_xp||s.xp||0),1):1;return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx(f,{size:28,className:"text-sky"}),e.jsx("h1",{className:"text-cream text-xl font-extrabold",children:"Hall of Fame"})]}),!t&&e.jsxs("div",{className:"game-panel p-10 text-center",children:[e.jsx(f,{size:48,className:"text-muted/20 mx-auto mb-4"}),e.jsx("p",{className:"text-cream text-lg font-bold",children:"Leaderboard Disabled"}),e.jsx("p",{className:"text-muted text-sm mt-2",children:"The leaderboard has been turned off in family settings."})]}),t&&h&&e.jsx("div",{className:"mb-4 p-3 rounded border-2 border-crimson/40 bg-crimson/10 text-crimson text-sm text-center",children:h}),t&&p&&e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(E,{size:32,className:"text-sky animate-spin"})}),t&&!p&&!h&&i.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(f,{size:48,className:"text-cream/10 mx-auto mb-4"}),e.jsx("p",{className:"text-cream text-lg font-bold",children:"No XP earned this week yet"}),e.jsx("p",{className:"text-muted text-sm mt-2",children:"Start questing!"})]}),t&&!p&&i.length>0&&e.jsxs("div",{className:"space-y-3",children:[i.slice(0,3).map((s,l)=>{const r=s.weekly_xp||s.xp||0,x=d>0?r/d*100:0,u=s.user_id===(a==null?void 0:a.id)||s.id===(a==null?void 0:a.id),o=s.quests_completed||0,n=s.current_streak||0,w=s.total_xp||0;return e.jsxs("div",{className:`game-panel p-4 flex items-center gap-3 ${u?"!border-sky":""}`,children:[e.jsx("div",{className:"flex-shrink-0 w-8 sm:w-12 text-center",children:e.jsx("span",{className:"text-2xl",children:q[l]})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(N,{config:s.avatar_config,size:"md",name:s.display_name||s.username,animate:!0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-cream text-sm font-bold truncate mb-1",children:s.display_name||s.username}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted",children:[e.jsx(S,{size:12,className:"text-sky"}),o," quest",o!==1?"s":""]}),n>0&&e.jsxs("span",{className:"flex items-center gap-1 text-muted",children:[e.jsx(L,{size:12,className:"text-orange-400"}),n," day",n!==1?"s":""]}),e.jsxs("span",{className:"text-muted/60",children:[w," total XP"]})]}),e.jsxs("div",{className:"xp-bar !h-5",children:[e.jsx(b.div,{className:"xp-bar-fill",initial:{width:0},animate:{width:`${x}%`},transition:{duration:1,delay:l*.15,ease:"easeOut"}}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-navy font-medium text-xs z-10",children:[r," XP this week"]})]})]})]},s.user_id||s.id||l)}),i.length>3&&e.jsx("div",{className:"mt-6 space-y-2",children:i.slice(3).map((s,l)=>{const r=l+4,x=s.weekly_xp||s.xp||0,u=d>0?x/d*100:0,o=s.user_id===(a==null?void 0:a.id)||s.id===(a==null?void 0:a.id),n=s.quests_completed||0;return e.jsxs("div",{className:`game-panel p-3 flex items-center gap-3 ${o?"!border-sky":""}`,children:[e.jsx("div",{className:"flex-shrink-0 w-8 text-center",children:e.jsxs("span",{className:"text-muted text-sm font-bold",children:["#",r]})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(N,{config:s.avatar_config,size:"sm",name:s.display_name||s.username,animate:!0})}),e.jsxs("div",{className:"min-w-0 flex-shrink",children:[e.jsx("p",{className:"text-cream text-sm truncate",children:s.display_name||s.username}),e.jsxs("p",{className:"text-muted text-xs",children:[n," quest",n!==1?"s":""," done"]})]}),e.jsx("div",{className:"flex-1 min-w-0 hidden sm:block",children:e.jsx("div",{className:"xp-bar !h-4",children:e.jsx(b.div,{className:"xp-bar-fill",initial:{width:0},animate:{width:`${u}%`},transition:{duration:.8,delay:(l+3)*.1,ease:"easeOut"}})})}),e.jsxs("span",{className:"flex-shrink-0 font-medium text-sky text-xs text-right ml-auto",children:[x," XP"]})]},s.user_id||s.id||r)})})]})]})}export{A as default};
